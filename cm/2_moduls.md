# Клас MODULS

**CLSID=16#220x**

to-do

## Загальний опис

Для HMI важливо реалізувати карти ПЛК, тобто стан каналів модулів (значення, використання змінною, помилки каналів), навіть якщо вони не використовуються. Крім того нерідко потрібно форсувати значення якогось виходу, або швидко дізнатися, яка змінна використовує даний канал. Найбільш простий варіант вивести на засоби HMI скорочені змінні структуру типу `CH_HMI`. Однак кількість тегів, що потрібна для ПЛК великої канальності надзвичайно велика, тому проміжним варіантом є використання виведення інформації по групам каналів, наприклад по 16, або по модулям. Приклади обох варіантів показані на рис.2.5.  Це якраз і реалізується за допомогою класу  [MODULS](2_moduls.md)

![Приклад відображення карт ПЛК](G:\san\PLCFramework\GitVer\cm\media\2_5.png)

_рис.2.5. Приклад відображення карт ПЛК_

Нижче описаний один з варіантів реалізації роботи з групою каналів. Функції, які реалізовуються:
- постійний контроль стану (відображення) помилки каналів (хоча б одного) на модулях
- вибір групи каналу для відображення (у даному прикладі групою по 16)
-  відображення стану каналів вибраної групи, відповідно до даних з структури CH_HMI
-  завантаження в буфер будь якого каналу з групи
-  робота з каналом через буфер (форсування, зміна значення)

Приклад структури:
## Структура MODULS
| Атрибут | Тип                        | Опис                                                         |
| ------- | -------------------------- | ------------------------------------------------------------ |
| ID      | UINT                       | Унікальний ідентифікатор, наприклад для ідентифікації PLC    |
| CLSID   | UINT                       | 16#220x                                                      |
| STRTNMB | UINT                       | номер початкового каналу для відображення                    |
| CNT     | UINT                       | LOBYTE: кількість каналів (залежить від модуля), не більше 16  <br/>HIBYTE: тип каналу (1- DICH, 2- DOCH, 3- AICH, 4 – AOCH) |
| CH      | ARRAY \[1 to 16\] of CHHMI | значення відповідно до CH\_HMI                               |
| STA1    | INT                        | стани BAD модулів 1 (16 шт)                                  |
| STA2    | INT                        | стани BAD модулів 2 (16 шт)                                  |
| ...     |                            |                                                              |
| STAn    | INT                        | стани BAD модулів 3 (16 шт)                                  |

![Приклад групування каналів для відображення на карті ПЛК](media/2_6.png)

_рис.2.6. Приклад групування каналів для відображення на карті ПЛК_


